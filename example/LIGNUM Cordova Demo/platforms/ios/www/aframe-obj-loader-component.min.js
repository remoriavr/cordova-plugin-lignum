!function(e){function t(r){if(a[r])return a[r].exports;var s=a[r]={exports:{},id:r,loaded:!1};return e[r].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){!function(e){return e?void(e.aframeCore||e).registerComponent("obj-loader",a(3)):void console.error("Component attempted to register before AFRAME was available.")}(window.AFRAME)},function(e,t){THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,a,r){var s=this,i=new THREE.XHRLoader(this.manager);i.setPath(this.path),i.load(e,function(e){t(s.parse(e))},a,r)},setPath:function(e){this.path=e},setBaseUrl:function(e){this.baseUrl=e},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split("\n"),a={},r=/\s+/,s={},i=0;i<t.length;i++){var o=t[i];if(o=o.trim(),0!==o.length&&"#"!==o.charAt(0)){var n=o.indexOf(" "),l=n>=0?o.substring(0,n):o;l=l.toLowerCase();var d=n>=0?o.substring(n+1):"";if(d=d.trim(),"newmtl"===l)a={name:d},s[d]=a;else if(a)if("ka"===l||"kd"===l||"ks"===l){var h=d.split(r,3);a[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else a[l]=d}}var u=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.materialOptions);return u.setCrossOrigin(this.crossOrigin),u.setManager(this.manager),u.setMaterials(s),u}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var a in e){var r=e[a],s={};t[a]=s;for(var i in r){var o=!0,n=r[i],l=i.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[1]&&(o=!1)}o&&(s[l]=n)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this.materialsInfo[e],a={name:e,side:this.side};for(var r in t){var s=t[r];if(""!==s)switch(r.toLowerCase()){case"kd":a.color=(new THREE.Color).fromArray(s);break;case"ks":a.specular=(new THREE.Color).fromArray(s);break;case"map_kd":a.map=this.loadTexture(this.baseUrl+s),a.map.wrapS=this.wrap,a.map.wrapT=this.wrap;break;case"ns":a.shininess=parseFloat(s);break;case"d":1>s&&(a.opacity=s,a.transparent=!0);break;case"Tr":s>0&&(a.opacity=1-s,a.transparent=!0);break;case"map_bump":case"bump":if(a.bumpMap)break;a.bumpMap=this.loadTexture(this.baseUrl+s),a.bumpMap.wrapS=this.wrap,a.bumpMap.wrapT=this.wrap}}return this.materials[e]=new THREE.MeshPhongMaterial(a),this.materials[e]},loadTexture:function(e,t,a,r,s){var i,o=THREE.Loader.Handlers.get(e),n=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===o&&(o=new THREE.TextureLoader(n)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),i=o.load(e,a,r,s),void 0!==t&&(i.mapping=t),i}},THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype)},function(e,t){THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,a,r){var s=this,i=new THREE.XHRLoader(s.manager);i.setPath(this.path),i.load(e,function(e){t(s.parse(e))},a,r)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},parse:function(e){function t(e){var t={vertices:[],normals:[],uvs:[]},a={name:"",smooth:!0};d={name:e,geometry:t,material:a},h.push(d)}function a(e){var t=parseInt(e);return 3*(t>=0?t-1:t+p.length/3)}function r(e){var t=parseInt(e);return 3*(t>=0?t-1:t+m.length/3)}function s(e){var t=parseInt(e);return 2*(t>=0?t-1:t+c.length/2)}function i(e,t,a){d.geometry.vertices.push(p[e],p[e+1],p[e+2],p[t],p[t+1],p[t+2],p[a],p[a+1],p[a+2])}function o(e,t,a){d.geometry.normals.push(m[e],m[e+1],m[e+2],m[t],m[t+1],m[t+2],m[a],m[a+1],m[a+2])}function n(e,t,a){d.geometry.uvs.push(c[e],c[e+1],c[t],c[t+1],c[a],c[a+1])}function l(e,t,l,d,h,u,p,m,c,f,E,v){var g,T=a(e),w=a(t),R=a(l);void 0===d?i(T,w,R):(g=a(d),i(T,w,g),i(w,R,g)),void 0!==h&&(T=s(h),w=s(u),R=s(p),void 0===d?n(T,w,R):(g=s(m),n(T,w,g),n(w,R,g))),void 0!==c&&(T=r(c),w=r(f),R=r(E),void 0===d?o(T,w,R):(g=r(v),o(T,w,g),o(w,R,g)))}console.time("OBJLoader");var d,h=[],u=!1,p=[],m=[],c=[];t("");for(var f=/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,E=/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,v=/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,g=/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,T=/^f\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)))?/,w=/^f\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)\/(-?\d+)))?/,R=/^f\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))(?:\s+((-?\d+)\/\/(-?\d+)))?/,M=/^[og]\s+(.+)/,b=/^s\s+(\d+|on|off)/,L=e.split("\n"),H=0;H<L.length;H++){var y=L[H];y=y.trim();var O;if(0!==y.length&&"#"!==y.charAt(0))if(null!==(O=f.exec(y)))p.push(parseFloat(O[1]),parseFloat(O[2]),parseFloat(O[3]));else if(null!==(O=E.exec(y)))m.push(parseFloat(O[1]),parseFloat(O[2]),parseFloat(O[3]));else if(null!==(O=v.exec(y)))c.push(parseFloat(O[1]),parseFloat(O[2]));else if(null!==(O=g.exec(y)))l(O[1],O[2],O[3],O[4]);else if(null!==(O=T.exec(y)))l(O[2],O[5],O[8],O[11],O[3],O[6],O[9],O[12]);else if(null!==(O=w.exec(y)))l(O[2],O[6],O[10],O[14],O[3],O[7],O[11],O[15],O[4],O[8],O[12],O[16]);else if(null!==(O=R.exec(y)))l(O[2],O[5],O[8],O[11],void 0,void 0,void 0,void 0,O[3],O[6],O[9],O[12]);else if(null!==(O=M.exec(y))){var x=O[1].trim();u===!1?(u=!0,d.name=x):t(x)}else if(/^usemtl /.test(y))d.material.name=y.substring(7).trim();else if(/^mtllib /.test(y));else{if(null===(O=b.exec(y)))throw new Error("Unexpected line: "+y);d.material.smooth="1"===O[1]||"on"===O[1]}}for(var A=new THREE.Group,H=0,k=h.length;k>H;H++){d=h[H];var F=d.geometry,C=new THREE.BufferGeometry;C.addAttribute("position",new THREE.BufferAttribute(new Float32Array(F.vertices),3)),F.normals.length>0?C.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(F.normals),3)):C.computeVertexNormals(),F.uvs.length>0&&C.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(F.uvs),2));var B;null!==this.materials&&(B=this.materials.create(d.material.name)),B||(B=new THREE.MeshPhongMaterial,B.name=d.material.name),B.shading=d.material.smooth?THREE.SmoothShading:THREE.FlatShading;var U=new THREE.Mesh(C,B);U.name=d.name,A.add(U)}return console.timeEnd("OBJLoader"),A}}},function(e,t,a){a(2),a(1),e.exports={dependencies:["material"],schema:{src:{"default":""},mtl:{"default":""}},update:function(){var e=this.el,t=this.data,a=this.model,r=this.parseUrl(t.src),s=this.parseUrl(t.mtl);a&&e.object3D.remove(a),r&&s?(e.components.material&&console.warn("Material component is ignored when a .MTL is provided"),this.loadObjMtl(r,s)):r?this.loadObj(r):console.warn("Model URL not provided")},loadObjMtl:function(e,t){var a=this,r=new THREE.MTLLoader;r.setBaseUrl(t.substr(0,t.lastIndexOf("/")+1)),r.load(t,function(t){t.preload();var r=new THREE.OBJLoader;r.setMaterials(t),r.load(e,function(e){a.model=e,a.el.object3D.add(e),a.el.emit("model-loaded",{format:"obj",model:e})})})},loadObj:function(e){var t=this,a=new THREE.OBJLoader;a.load(e,function(e){t.model=e,t.applyMaterial(),t.el.object3D.add(e),t.el.emit("model-loaded",{format:"obj",model:e})})},applyMaterial:function(){var e=this.el.components.material.material;this.model&&this.model.traverse(function(t){t instanceof THREE.Mesh&&(t.material=e)})},parseUrl:function(e){var t=e.match(/\url\((.+)\)/);if(t)return t[1]}}}]);